(Jack, add the weighting code here)
